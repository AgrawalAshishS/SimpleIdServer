
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>Provisioning - SimpleIdServer</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="SimpleIdServer" class="md-header__button md-logo" aria-label="SimpleIdServer" data-md-component="logo">
      
  <img src="../assets/SIDLogo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SimpleIdServer
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Provisioning
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="SimpleIdServer" class="md-nav__button md-logo" aria-label="SimpleIdServer" data-md-component="logo">
      
  <img src="../assets/SIDLogo.svg" alt="logo">

    </a>
    SimpleIdServer
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../bigpicture/" class="md-nav__link">
        Big Picture
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../gettingstarted/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../openid/" class="md-nav__link">
        OPENID
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../scim20/" class="md-nav__link">
        SCIM2.0
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../saml20/" class="md-nav__link">
        SAML2.0
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../uma20/" class="md-nav__link">
        UMA2.0
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../fapi/" class="md-nav__link">
        FAPI
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Provisioning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Provisioning
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started-with-provisioning" class="md-nav__link">
    Getting started with Provisioning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-provisioning" class="md-nav__link">
    Configure Provisioning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-bpmn-workflow" class="md-nav__link">
    Configure BPMN workflow
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started-with-provisioning" class="md-nav__link">
    Getting started with Provisioning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-provisioning" class="md-nav__link">
    Configure Provisioning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-bpmn-workflow" class="md-nav__link">
    Configure BPMN workflow
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Provisioning</h1>
                
                <h2 id="introduction">Introduction</h2>
<p>The provisioning lets you:</p>
<ul>
<li><strong>Automate Provisioning</strong> : Automatically create new accounts in the right systems for new people when they join your team or organization. </li>
<li><strong>Automate Deprovisioning</strong> : Automatically deactivate accounts in the right systems when people leave the team or organization.</li>
<li><strong>Just In Time Provisioning</strong> : Automatically create new accounts in the right systems for new people when they authenticate to an external identity provider.</li>
<li><strong>Credential Provisioning</strong> : Automatically ask to the users to submit their credentials. </li>
</ul>
<p>SCIM2.0 API is the entry point for users and groups management (for more details refer to this <a href="../scim20/">part</a>).
It is used by external clients for maintaining data consistency between multiple identity providers for example : between an active Directory and an OPENID Identity Provider. </p>
<p><img alt="Provisioning workflow" src="images/provisioning-1.png" /></p>
<p>The workflow above describes the user provisioning / deprovisioning implementation made by SimpleIdServer. The credential provisioning is done by a BPMN workflow.  </p>
<ol>
<li>A user arrives in the Active Directory.</li>
<li>An HTTP REQUEST is sent to the SCIM2.0 API in order to create, update or delete users. </li>
<li>An external event is published to the message broker. </li>
<li>The message is fetched and processed by the Provisioning windows service. </li>
<li>Based on the nature of the message, the windows service executes a sequence of actions : Launch the BPMN workflow and send an HTTP request. The windows service can be configured via the administration portal. </li>
<li>If the message received is “new user” then a BPMN workflow is launched, it will create and assign a human task to the end user. It will be used by the end user to update their credentials.</li>
<li>Execute an HTTP request in order to add, delete or update user from one identity provider.</li>
</ol>
<h2 id="getting-started-with-provisioning">Getting started with Provisioning</h2>
<p>This chapter explains how to automatically provision a user who is authenticating with an external identity provider. This scenario is called "Just In Time Provisioning". </p>
<p>Before starting, ensure that SimpleIdServer is properly configured and installed on your machine:</p>
<ol>
<li>Open the <a href="http://localhost:4200">administration portal</a> and authenticate with an external identity provider (Facebook, SAMLIDP etc…). </li>
</ol>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Login</td>
<td>sub</td>
</tr>
<tr>
<td>Password</td>
<td>password</td>
</tr>
</tbody>
</table>
<ol>
<li>Navigate to the “Tasks” page and open the first task. Update your password and click on confirm.  </li>
<li>Close your session and connect with an administrator account. </li>
</ol>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Login</td>
<td>administrator</td>
</tr>
<tr>
<td>Password</td>
<td>password</td>
</tr>
</tbody>
</table>
<ol>
<li>Navigate to the <a href="http://localhost:4200/users">Users</a> page. Only one user is displayed, it corresponds to the user who authenticate with an external identity provider. Thanks to "Just In Time provisioning" mechanism, users who successfully authenticate with external identity providers automatically have local account. </li>
</ol>
<p><img alt="Users" src="images/provisioning-2.png" /></p>
<ol>
<li>Navigate to the <a href="http://localhost:4200/provisioning/history">Provisioning &gt;&gt; History</a> page. The history of user provisioning is displayed. </li>
</ol>
<p><img alt="History" src="images/provisioning-3.png" /></p>
<ol>
<li>Click on the link "Workflow".</li>
<li>The BPMN workflow is used to get password from the end-user. It generates a link, sends and email, create and assign a human task to the end user. By default there is one error in the workflow instance because the SMTP configuration is incorrect. </li>
</ol>
<p><img alt="Workflow" src="images/provisioning-4.png" /></p>
<h2 id="configure-provisioning">Configure Provisioning</h2>
<p>The configuration of the provisioning windows service can be updated in the page <a href="http://localhost:4200/provisioning/configurations">Provisioning &gt;&gt; Configuration</a>. The following properties can be updated : </p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tokenEdp</td>
<td>URL of the token endpoint. Used by the provisioning service in order to get an access token valid on the scope specified by the property “scopes”.</td>
</tr>
<tr>
<td>clientId</td>
<td>Client Identifier</td>
</tr>
<tr>
<td>clientSecret</td>
<td>Client Secret</td>
</tr>
<tr>
<td>scopes</td>
<td>List of scopes</td>
</tr>
<tr>
<td>targetUrl</td>
<td>URL where the JSON request will be sent</td>
</tr>
<tr>
<td>httpRequestTemplate</td>
<td>This template is used to generate the JSON request. It will be send to the "targetUrl".</td>
</tr>
<tr>
<td>bpmnHost</td>
<td>URL of the BPMN REST.API</td>
</tr>
<tr>
<td>bpmnFileId</td>
<td>Identifier of the BPMN file</td>
</tr>
<tr>
<td>messageToken</td>
<td>This template is used to generate the JSON request. It will be sent to the "bpmnHost" in order to launch the BPMN workflow.</td>
</tr>
</tbody>
</table>
<h2 id="configure-bpmn-workflow">Configure BPMN workflow</h2>
<p>The BPMN workflow is used to create and assign human tasks to the end-user in order to get the credential. Its definition is accessible in the page "Provisioning &gt;&gt; Workflows". </p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../fapi/" class="md-footer__link md-footer__link--prev" aria-label="Previous: FAPI" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              FAPI
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.756773cc.min.js"></script>
      
    
  </body>
</html>