<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Authentication Methods </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Authentication Methods ">
    <meta name="generator" content="docfx 2.58.3.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    
    
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="authentication-methods">Authentication Methods</h1>

<h2 id="authentication-context-class-reference-acr">Authentication Context Class Reference (ACR)</h2>
<p>The Authentication Context Class Reference (ACR) specifies a set of business rules that the authentications are being requested to satisfy.
These rules can often be satisfied by using a number of different authentication methods, either singly or in combination.</p>
<p>In short, the Authentication Context Class Reference (ACR) ensures the correctness of the user identity.
In SimpleIdServer, the ACR is similar to the Level Of Assurance. The higher your Level Of Assurance, the better the identity of a user can be trusted.</p>
<p>It's up to the Relying Party to specify the ACR value. This value is passed in the <code>acr_values</code> parameter with the authorization query.</p>
<p><strong>Example</strong> : If you want to authenticate with a Level Of Assurance equals to 2, navigate to the following URL : <a href="https://localhost:5001/authorization?client_id=umaClient&amp;redirect_uri=https://localhost:60001/signin-oidc&amp;response_type=code&amp;scope=openid%20profile&amp;state=state&amp;acr_values=sid-load-02&amp;prompt=login">https://localhost:5001/authorization?client_id=umaClient&amp;redirect_uri=https://localhost:60001/signin-oidc&amp;response_type=code&amp;scope=openid%20profile&amp;state=state&amp;acr_values=sid-load-02&amp;prompt=login</a>.
During the authentication flow, the user agent will be redirected to the <code>Password</code> and <code>Sms</code> authentication window.</p>
<p>The list of Authentication Context Class Reference (ACR) can be configured in the <code>OpenIdDefaultConfiguration.cs</code> file.</p>
<p>By default, there are two ACR values : <code>sid-load-01</code> and <code>sid-load-02</code>.</p>
<pre><code>public static List&lt;AuthenticationContextClassReference&gt; AcrLst =&gt; new List&lt;AuthenticationContextClassReference&gt;
{
    new AuthenticationContextClassReference
    {
        DisplayName = &quot;First level of assurance&quot;,
        Name = &quot;sid-load-01&quot;,
        AuthenticationMethodReferences = new List&lt;string&gt;
        {
            &quot;pwd&quot;
        }
    },
    new AuthenticationContextClassReference
    {
        DisplayName = &quot;Second level of assurance&quot;,
        Name = &quot;sid-load-02&quot;,
        AuthenticationMethodReferences = new List&lt;string&gt;
        {
            &quot;pwd&quot;,
            &quot;sms&quot;
        }
    }
};
</code></pre>
<p>The list of available authentication methods are described in the next chapters.</p>
<table>
<thead>
<tr>
<th>Authentication Method</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>pwd</td>
<td>Login Password Authentication</td>
</tr>
<tr>
<td>email</td>
<td>Email Authentication</td>
</tr>
<tr>
<td>sms</td>
<td>Sms Authentication</td>
</tr>
</tbody>
</table>
<h2 id="login-password-authentication">Login Password Authentication</h2>
<p><strong>Authentication method</strong> : pwd</p>
<p>The Login/Password authentication is included and configured in all the OPENID templates.
There is no need to do manual changes.</p>
<h2 id="email-authentication">Email Authentication</h2>
<p><strong>Authentication method</strong> : email</p>
<p>An OPENID server with Login/Password and Email authentications can be installed like this.</p>
<pre><code>mkdir QuickStart
cd QuickStart

mkdir src
cd src

dotnet new openidemail -n OpenIdEmail
</code></pre>
<ul>
<li>Open the <code>OpenIdStartup.cs</code> and replace the <code>SMTPUSERNAME</code>, <code>SMTPPASSWORD</code>, <code>FROMEMAIL</code>, <code>SMTPHOST</code>, <code>SMTPPORT</code> with the correct values.</li>
</ul>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>SmtpUserName</td>
<td>Email is used to authenticate against the SMTP server</td>
<td></td>
</tr>
<tr>
<td>SmtpPassword</td>
<td>Password is used to authenticate against the SMTP server</td>
<td></td>
</tr>
<tr>
<td>FromEmail</td>
<td>Sender of the email</td>
<td></td>
</tr>
<tr>
<td>SmtpHost</td>
<td>SMTP Host</td>
<td>smtp.gmail.com</td>
</tr>
<tr>
<td>SmtpPort</td>
<td>SMTP Port</td>
<td>587</td>
</tr>
</tbody>
</table>
<ul>
<li>Edit the <code>OpenIdDefaultConfiguration.cs</code> file and add an ACR :</li>
</ul>
<pre><code>new AuthenticationContextClassReference
{
    DisplayName = &quot;Second level of assurance&quot;,
    Name = &quot;sid-load-02-1&quot;,
    AuthenticationMethodReferences = new List&lt;string&gt;
    {
        &quot;pwd&quot;,
        &quot;email&quot;
    }
}
</code></pre>
<ul>
<li>Always in the <code>OpenIdDefaultConfiguration.cs</code> file, update the EMAIL with yours :</li>
</ul>
<pre><code>new UserClaim(Jwt.Constants.UserClaims.Email, &quot;&lt;&lt;EMAIL&gt;&gt;&quot;)
</code></pre>
<ul>
<li>Run the application</li>
</ul>
<pre><code>dotnet run --urls=https://localhost:5001
</code></pre>
<ul>
<li>Navigate to this URL <a href="https://localhost:5001/authorization?client_id=umaClient&amp;redirect_uri=https://localhost:60001/signin-oidc&amp;response_type=code&amp;scope=openid%20profile&amp;state=state&amp;acr_values=sid-load-02-1&amp;prompt=login">https://localhost:5001/authorization?client_id=umaClient&amp;redirect_uri=https://localhost:60001/signin-oidc&amp;response_type=code&amp;scope=openid%20profile&amp;state=state&amp;acr_values=sid-load-02-1&amp;prompt=login</a></li>
<li>Submit the credentials - Login : <code>sub</code>, Password : <code>password</code>.</li>
<li>Submit the confirmation code received on your email.</li>
</ul>
<p><img src="images/openid-4.png" alt="Confirmation code"></p>
<h2 id="sms-authentication">SMS Authentication</h2>
<p><strong>Authentication method</strong> : sms</p>
<p>SimpleIdServer is using <a href="https://www.twilio.com/">Twilio</a> to send confirmation code to phones.</p>
<p>An OPENID server with Login/Password and SMS authentications can be installed like this.</p>
<pre><code>mkdir QuickStart
cd QuickStart

mkdir src
cd src

dotnet new openidsms -n OpenIdSms
</code></pre>
<ul>
<li>Open the <code>OpenIdStartup.cs</code> and replace the <code>ACCOUNTSID</code>, <code>AUTHTOKEN</code> and <code>FROMPHONENUMBER</code> with the correct values, for more information refer to the <a href="https://support.twilio.com/hc/en-us/articles/223136027-Auth-Tokens-and-How-to-Change-Them">official website</a>.</li>
</ul>
<pre><code>AddSMSAuthentication(opts =&gt;
{
    opts.AccountSid = &quot;&lt;&lt;ACCOUNTSID&gt;&gt;&quot;;
    opts.AuthToken = &quot;&lt;&lt;AUTHTOKEN&gt;&gt;&quot;;
    opts.FromPhoneNumber = &quot;&lt;&lt;FROMPHONENUMBER&gt;&gt;&quot;;
})
</code></pre>
<p><img src="images/openid-2.png" alt="Twilio Configuration"></p>
<ul>
<li>Open the <code>OpenIdDefaultConfiguration.cs</code> file, and update the PHONENUMBER with yours :</li>
</ul>
<pre><code>new UserClaim(SimpleIdServer.Jwt.Constants.UserClaims.PhoneNumber, &quot;&lt;&lt;PHONENUMBER&gt;&gt;&quot;)
</code></pre>
<ul>
<li>Run the application.</li>
</ul>
<pre><code>dotnet run --urls=https://localhost:5001
</code></pre>
<ul>
<li>Navigate to this URL <a href="https://localhost:5001/authorization?client_id=umaClient&amp;redirect_uri=https://localhost:60001/signin-oidc&amp;response_type=code&amp;scope=openid%20profile&amp;state=state&amp;acr_values=sid-load-02&amp;prompt=login">https://localhost:5001/authorization?client_id=umaClient&amp;redirect_uri=https://localhost:60001/signin-oidc&amp;response_type=code&amp;scope=openid%20profile&amp;state=state&amp;acr_values=sid-load-02&amp;prompt=login</a></li>
<li>Submit the credentials - Login : <code>sub</code>, Password : <code>password</code>.</li>
<li>Submit the confirmation code received on your phone.</li>
</ul>
<p><img src="images/openid-3.png" alt="Confirmation code"></p>
<h2 id="sms-and-email-authentication">SMS and Email authentication</h2>
<p><strong>Authentication methods</strong> : sms and email</p>
<p>An OPENID server with all the authentication methods can be installed like this :</p>
<pre><code>mkdir QuickStart
cd QuickStart

mkdir src
cd src

dotnet new openidfull -n OpenIdFull
</code></pre>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/simpleidserver/SimpleIdServer/blob/release/2.0.4/docs/documentation/openid/authentication.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
